# その他

## 目次
<!-- TOC -->

- [その他](#%E3%81%9D%E3%81%AE%E4%BB%96)
    - [目次](#%E7%9B%AE%E6%AC%A1)
    - [巻き上げ](#%E5%B7%BB%E3%81%8D%E4%B8%8A%E3%81%92)
    - [比較演算子と同等性](#%E6%AF%94%E8%BC%83%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%A8%E5%90%8C%E7%AD%89%E6%80%A7)
    - [コメント](#%E3%82%B3%E3%83%A1%E3%83%B3%E3%83%88)
    - [空白](#%E7%A9%BA%E7%99%BD)
    - [カンマ](#%E3%82%AB%E3%83%B3%E3%83%9E)
    - [セミコロン](#%E3%82%BB%E3%83%9F%E3%82%B3%E3%83%AD%E3%83%B3)
    - [アクセサ](#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B5)
    - [イベント](#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88)
    - [ブロック](#%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF)
    - [制御ステートメント](#%E5%88%B6%E5%BE%A1%E3%82%B9%E3%83%86%E3%83%BC%E3%83%88%E3%83%A1%E3%83%B3%E3%83%88)
    - [jQuery](#jquery)
    - [標準ライブラリ](#%E6%A8%99%E6%BA%96%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA)

<!-- /TOC -->
## 巻き上げ

* `var`宣言は、それらに最も近い包含関数スコープの一番上に引き上げられますが、それらの代入は引き継がれません。`const`と`let`の宣言はTemporal Dead Zones(TDZ)と呼ばれる新しい概念の恩恵を受けています。なぜtypeofが安全ではなくなったのかを知ることは重要です。
* 無名関数の場合、関数が割当てされる前の変数が巻き上げられます。
* 名前付き関数の場合も同様に変数が巻き上げられます。関数名や関数本体は巻き上げられません。
* 関数宣言は関数名と関数本体が巻き上げられます。

## 比較演算子と同等性

* `if`文のような条件式は`ToBoolean`メソッドによる強制型変換で評価され、常に以下のルールに従います。

+ オブジェクトはtrueと評価されます。
+ undefinedはfalseと評価されます。
+ nullはfalseと評価されます。
+ 真偽値はboolean型の値として評価されます。
+ 数値はtrueと評価されます。しかし、+0, -0, NaNの場合は falseです。
+ 文字列はtrueと評価されます。しかし、空文字`''`の場合はfalse です。

* 真偽値にはショートカットを使用しますが、文字列と数値には明示的な比較を使用すること。
* `case`と`default`節でブロックを作成するには中括弧(`{}`)を使うこと。(例えば `let`、`const`、`function`、`class`) レキシカル宣言は`switch`ブロック全体から参照することができますが、代入されたときにだけ初期化され、それは`case`に達したときにだけ起こります。複数の`case`節が同じものを定義しようとするとき、これは問題を引き起こします。
* 三項演算子は入れ子にするべきではなく、一般に単一行にします。
* 不要な三項演算子を避ける。
* 演算子を混在させる場合は、それらを括弧で囲むこと。唯一の例外は、標準の算術演算子（`+`、`-`、`*`、`/`）です。これにより読みやすさが向上し、開発者の意図が明確になります。

## コメント

* 複数行のコメントには`/ ** ... * /`を使用すること。
* 単一行コメントには`//`を使用すること。コメントを加えたいコードの上部に配置すること。また、コメントの前に空行を入ること。
* 読みやすくするために、すべてのコメントをスペースで始めること。
* 問題を指摘して再考を促す場合や、問題の解決策を提案する場合など、コメントの前に`FIXME`や`TODO`を付けることで他の開発者の素早い理解を助けることができます。これらは、何らかのアクションを伴うという意味で通常のコメントとは異なります。アクションとは`FIXME -- 解決策が必要`もしくは`TODO -- 実装が必要`です。
* 問題に対する注釈として`// FIXME:`を使用すること。
* 問題の解決策に対する注釈として`// TODO:`を使用すること。

## 空白

* 半角スペース2文字を使用すること。
* 重要な中括弧（`{}`）の前にはスペースを1つ入れること。
* 制御構文（`if`文や`while`文など）の丸括弧（`()`）の前にはスペースを1つ入れること。関数宣言や関数呼び出し時の引数リストの前にはスペースは入れない。
* 演算子の間はスペースを入れること。
* ファイルの最後は改行文字を1つ入れること。
* 長くメソッドを連結する場合はインデントを使用すること。行がメソッド呼び出しではなく、新しい文であることを強調するために先頭にドット(.)を配置すること。
* 文の前とブロックの後には改行を残すこと。
* ブロックに空行を挟み込まない。
* 丸括弧(`()`)の内側にスペースを追加しない。
* 角括弧(`[]`)の内側にスペースを追加しない。
* 中括弧(`{}`)の内側にスペースを追加すること。
* 100文字を超えるコード行（空白を含む）を避ける。長い文字列はこの規則から除外されており、分割しない。
* 開いている中括弧(`{`)と同じ行の次の中括弧(`}`)の間に一定のスペースを空けること。この規則は、同じ行の閉じ中括弧(`}`)と前の中括弧(`{`)との間に一貫性のあるスペースを適用します。
* コンマの前にスペースを入れず、コンマの後にスペースを入れること。
* 計算用プロパティの括弧の中のスペースを強制する。
* 関数とその呼び出しの間にスペースを入れない。
* オブジェクトリテラルプロパティのキーと値の間のスペースを入れること。
* 行末に末尾のスペースを入れない。
* 複数の空行を避け、ファイルの終わりには改行を1つだけ入れること。

## カンマ

* 先頭のカンマは禁止。末尾につけること。

## セミコロン

* 改行をする時は必ずつけて下さい。

## アクセサ

* プロパティのためのアクセサ関数は必須ではありません。
* 予期しない副作用を引き起こし、テスト、保守、および理由の説明が難しいため、JavaScriptのゲッター/セッターは使用しないこと。代わりに、アクセサ関数を作るのであれば、`getVal()`とか`setVal('hello')`とすること。
* プロパティ/メソッドが`boolean`の場合は、`isVal()`または`hasVal()`を使用すること。
* 一貫していれば、`get()`や`set()`という関数を作成することを認める。

## イベント

* データペイロードをイベント（DOMイベントまたはBackboneイベントのようなもっと独自のものかどうかにかかわらず）に添付するときは、生の値の代わりにオブジェクトリテラル（「ハッシュ」とも呼ばれる）を渡すこと。これにより、後の開発者は、イベントのすべてのハンドラを見つけて更新することなく、イベントペイロードにさらにデータを追加できます。
たとえば、下の例より、
```js
// bad
$(this).trigger('listingUpdated', listing.id);

...

$(this).on('listingUpdated', function(e, listingId) {
  // do something with listingId
});
```
こちらの方が好まれます:
```js
// good
$(this).trigger('listingUpdated', { listingId: listing.id });

...

$(this).on('listingUpdated', function(e, data) {
  // do something with data.listingId
});
```
## ブロック

* 複数行のブロックには中括弧（`{}`）を使用すること。
* `if`と`else`を使った複数行のブロックの場合は、`else`ブロックの閉じ括弧と同じ行に`else`を置くこと。
* `if`ブロックが常にreturn文を実行するのであれば、それに続く`else`ブロックは不要です。`return`を含む`if`ブロックに続く `else if`ブロック内の`return`は複数の`if`ブロックに分けることができます。

## 制御ステートメント

* 制御文（`if`、`while`など）が長くなり過ぎたり、最大行長を超えたりした場合、それぞれの（グループ化された）条件は新しい行に入れること。そして論理演算子で行を始めること。行の先頭で演算子を要求すると、演算子は整列されたままになり、メソッド連結と同様のパターンに従います。これにより、複雑なロジックを視覚的に理解しやすくなるため、読みやすくなります。
* 後続処理を選択するための演算子を制御文の代わりに使用しない。

## jQuery

* jQueryオブジェクトの変数は、先頭に`$`を付与すること。
* jQueryの検索結果をキャッシュすること。
* DOMの検索には、`$('.sidebar ul')`や`$('.sidebar > ul')`のカスケードを使用すること。
* jQueryオブジェクトの検索には、スコープ付きの`find`を使用すること。

## 標準ライブラリ

標準ライブラリには機能的には壊れているがレガシーな理由で残っているユーティリティが含まれています。
* グローバルな`isNaN`の代わりに`Number.isNaN`を使用すること。
* グローバルな`isFinite`の代わりに`Number.isFinite`を使用する。